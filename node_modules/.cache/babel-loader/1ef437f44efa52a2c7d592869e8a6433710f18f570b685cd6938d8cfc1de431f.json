{"ast":null,"code":"import _objectSpread from \"D:/\\u56FE\\u4E66\\u7BA1\\u7406\\u7CFB\\u7EDF/library/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _regenerator from \"D:/\\u56FE\\u4E66\\u7BA1\\u7406\\u7CFB\\u7EDF/library/node_modules/@babel/runtime/helpers/esm/regenerator.js\";\nimport _asyncToGenerator from \"D:/\\u56FE\\u4E66\\u7BA1\\u7406\\u7CFB\\u7EDF/library/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport axios from 'axios';\nexport default {\n  data: function data() {\n    return {\n      books: [],\n      searchQuery: '',\n      showAddModal: false,\n      showEditModal: false,\n      showConfirmDeleteModal: false,\n      selectedBooks: [],\n      addForm: {\n        title: '',\n        author: '',\n        isbn: '',\n        publishDate: '',\n        stock: 0\n      },\n      editForm: {\n        id: '',\n        title: '',\n        author: '',\n        isbn: '',\n        publishDate: '',\n        stock: 0\n      },\n      formRules: {\n        title: [{\n          required: true,\n          message: '请输入书名',\n          trigger: 'blur'\n        }],\n        author: [{\n          required: true,\n          message: '请输入作者',\n          trigger: 'blur'\n        }],\n        isbn: [{\n          required: true,\n          message: '请输入ISBN',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  created: function created() {\n    this.fetchBookList();\n  },\n  methods: {\n    fetchBookList: function fetchBookList() {\n      var _arguments = arguments,\n        _this = this;\n      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee() {\n        var query, response, _t;\n        return _regenerator().w(function (_context) {\n          while (1) switch (_context.n) {\n            case 0:\n              query = _arguments.length > 0 && _arguments[0] !== undefined ? _arguments[0] : '';\n              _context.p = 1;\n              _context.n = 2;\n              return axios.get(\"/api/books?search=\".concat(query));\n            case 2:\n              response = _context.v;\n              _this.books = response.data;\n              _context.n = 4;\n              break;\n            case 3:\n              _context.p = 3;\n              _t = _context.v;\n              console.error('获取图书列表失败:', _t);\n              _this.$message.error('获取图书列表失败');\n            case 4:\n              return _context.a(2);\n          }\n        }, _callee, null, [[1, 3]]);\n      }))();\n    },\n    handleSelectionChange: function handleSelectionChange(val) {\n      this.selectedBooks = val.map(function (item) {\n        return item.id;\n      });\n    },\n    handleEdit: function handleEdit(row) {\n      this.editForm = _objectSpread({}, row);\n      this.showEditModal = true;\n    },\n    onSearch: function onSearch() {\n      this.fetchBookList(this.searchQuery);\n    },\n    submitAdd: function submitAdd() {\n      var _this2 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee2() {\n        var _t2;\n        return _regenerator().w(function (_context2) {\n          while (1) switch (_context2.n) {\n            case 0:\n              _context2.p = 0;\n              _context2.n = 1;\n              return _this2.$refs.addFormRef.validate();\n            case 1:\n              _context2.n = 2;\n              return axios.post('/api/books', _this2.addForm);\n            case 2:\n              _this2.showAddModal = false;\n              _this2.fetchBookList();\n              _this2.$message.success('添加成功');\n              _context2.n = 4;\n              break;\n            case 3:\n              _context2.p = 3;\n              _t2 = _context2.v;\n              _this2.$message.error('添加失败');\n            case 4:\n              return _context2.a(2);\n          }\n        }, _callee2, null, [[0, 3]]);\n      }))();\n    },\n    submitEdit: function submitEdit() {\n      var _this3 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee3() {\n        var _t3;\n        return _regenerator().w(function (_context3) {\n          while (1) switch (_context3.n) {\n            case 0:\n              _context3.p = 0;\n              _context3.n = 1;\n              return _this3.$refs.editFormRef.validate();\n            case 1:\n              _context3.n = 2;\n              return axios.put(\"/api/books/\".concat(_this3.editForm.id), _this3.editForm);\n            case 2:\n              _this3.showEditModal = false;\n              _this3.fetchBookList();\n              _this3.$message.success('更新成功');\n              _context3.n = 4;\n              break;\n            case 3:\n              _context3.p = 3;\n              _t3 = _context3.v;\n              _this3.$message.error('更新失败');\n            case 4:\n              return _context3.a(2);\n          }\n        }, _callee3, null, [[0, 3]]);\n      }))();\n    },\n    handleSingleDelete: function handleSingleDelete(id) {\n      this.selectedBooks = [id];\n      this.showConfirmDeleteModal = true;\n    },\n    submitBatchDelete: function submitBatchDelete() {\n      var _this4 = this;\n      return _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee4() {\n        var _t4;\n        return _regenerator().w(function (_context4) {\n          while (1) switch (_context4.n) {\n            case 0:\n              _context4.p = 0;\n              _context4.n = 1;\n              return axios[\"delete\"]('/api/books', {\n                data: {\n                  ids: _this4.selectedBooks\n                }\n              });\n            case 1:\n              _this4.showConfirmDeleteModal = false;\n              _this4.fetchBookList();\n              _this4.$message.success('删除成功');\n              _context4.n = 3;\n              break;\n            case 2:\n              _context4.p = 2;\n              _t4 = _context4.v;\n              _this4.$message.error('删除失败');\n            case 3:\n              return _context4.a(2);\n          }\n        }, _callee4, null, [[0, 2]]);\n      }))();\n    }\n  }\n};","map":{"version":3,"names":["axios","data","books","searchQuery","showAddModal","showEditModal","showConfirmDeleteModal","selectedBooks","addForm","title","author","isbn","publishDate","stock","editForm","id","formRules","required","message","trigger","created","fetchBookList","methods","_arguments","arguments","_this","_asyncToGenerator","_regenerator","m","_callee","query","response","_t","w","_context","n","length","undefined","p","get","concat","v","console","error","$message","a","handleSelectionChange","val","map","item","handleEdit","row","_objectSpread","onSearch","submitAdd","_this2","_callee2","_t2","_context2","$refs","addFormRef","validate","post","success","submitEdit","_this3","_callee3","_t3","_context3","editFormRef","put","handleSingleDelete","submitBatchDelete","_this4","_callee4","_t4","_context4","ids"],"sources":["src/views/BookManagement.vue"],"sourcesContent":["<template>\r\n  <div class=\"book-management\">\r\n    <el-row :gutter=\"10\" class=\"mb-20\">\r\n      <el-col :span=\"6\">\r\n        <el-input v-model=\"searchQuery\" placeholder=\"请输入书名/作者/ISBN\" @keyup.enter.native=\"onSearch\">\r\n          <el-button slot=\"append\" icon=\"el-icon-search\" @click=\"onSearch\" />\r\n        </el-input>\r\n      </el-col>\r\n      <el-col :span=\"6\">\r\n        <el-button type=\"primary\" @click=\"showAddModal = true\">添加图书</el-button>\r\n        <el-button type=\"danger\" @click=\"showConfirmDeleteModal = true\">批量删除</el-button>\r\n      </el-col>\r\n    </el-row>\r\n\r\n    <el-table :data=\"books\" border @selection-change=\"handleSelectionChange\">\r\n      <el-table-column type=\"selection\" width=\"55\" />\r\n      <el-table-column prop=\"title\" label=\"书名\" width=\"200\" />\r\n      <el-table-column prop=\"author\" label=\"作者\" width=\"150\" />\r\n      <el-table-column prop=\"isbn\" label=\"ISBN\" width=\"180\" />\r\n      <el-table-column prop=\"publishDate\" label=\"出版日期\" width=\"150\" />\r\n      <el-table-column prop=\"stock\" label=\"库存\" width=\"100\" />\r\n      <el-table-column label=\"操作\" width=\"200\">\r\n        <template slot-scope=\"{row}\">\r\n          <el-button size=\"small\" @click=\"handleEdit(row)\">编辑</el-button>\r\n          <el-button size=\"small\" type=\"danger\" @click=\"handleSingleDelete(row.id)\">删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n\r\n    <!-- 添加图书弹窗 -->\r\n    <el-dialog title=\"添加图书\" :visible.sync=\"showAddModal\">\r\n      <el-form ref=\"addFormRef\" :model=\"addForm\" :rules=\"formRules\" label-width=\"100px\">\r\n        <el-form-item label=\"书名\" prop=\"title\">\r\n          <el-input v-model=\"addForm.title\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"作者\" prop=\"author\">\r\n          <el-input v-model=\"addForm.author\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"ISBN\" prop=\"isbn\">\r\n          <el-input v-model=\"addForm.isbn\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"出版日期\" prop=\"publishDate\">\r\n          <el-date-picker v-model=\"addForm.publishDate\" type=\"date\" value-format=\"yyyy-MM-dd\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"库存\" prop=\"stock\">\r\n          <el-input-number v-model=\"addForm.stock\" :min=\"0\" />\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"submitAdd\">立即创建</el-button>\r\n          <el-button @click=\"showAddModal = false\">取消</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-dialog>\r\n\r\n    <!-- 编辑图书弹窗 -->\r\n    <el-dialog title=\"编辑图书\" :visible.sync=\"showEditModal\">\r\n      <el-form ref=\"editFormRef\" :model=\"editForm\" :rules=\"formRules\" label-width=\"100px\">\r\n        <el-form-item label=\"书名\" prop=\"title\">\r\n          <el-input v-model=\"editForm.title\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"作者\" prop=\"author\">\r\n          <el-input v-model=\"editForm.author\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"ISBN\" prop=\"isbn\">\r\n          <el-input v-model=\"editForm.isbn\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"出版日期\" prop=\"publishDate\">\r\n          <el-date-picker v-model=\"editForm.publishDate\" type=\"date\" value-format=\"yyyy-MM-dd\" />\r\n        </el-form-item>\r\n        <el-form-item label=\"库存\" prop=\"stock\">\r\n          <el-input-number v-model=\"editForm.stock\" :min=\"0\" />\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button type=\"primary\" @click=\"submitEdit\">立即更新</el-button>\r\n          <el-button @click=\"showEditModal = false\">取消</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-dialog>\r\n\r\n    <!-- 确认删除弹窗 -->\r\n    <el-dialog title=\"警告\" :visible.sync=\"showConfirmDeleteModal\">\r\n      <span>确定要删除选中的{{ selectedBooks.length }}本书吗？</span>\r\n      <span slot=\"footer\">\r\n        <el-button @click=\"showConfirmDeleteModal = false\">取消</el-button>\r\n        <el-button type=\"danger\" @click=\"submitBatchDelete\">确认删除</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      books: [],\r\n      searchQuery: '',\r\n      showAddModal: false,\r\n      showEditModal: false,\r\n      showConfirmDeleteModal: false,\r\n      selectedBooks: [],\r\n      addForm: {\r\n        title: '',\r\n        author: '',\r\n        isbn: '',\r\n        publishDate: '',\r\n        stock: 0\r\n      },\r\n      editForm: {\r\n        id: '',\r\n        title: '',\r\n        author: '',\r\n        isbn: '',\r\n        publishDate: '',\r\n        stock: 0\r\n      },\r\n      formRules: {\r\n        title: [{ required: true, message: '请输入书名', trigger: 'blur' }],\r\n        author: [{ required: true, message: '请输入作者', trigger: 'blur' }],\r\n        isbn: [{ required: true, message: '请输入ISBN', trigger: 'blur' }]\r\n      }\r\n    };\r\n  },\r\n  created() {\r\n    this.fetchBookList();\r\n  },\r\n  methods: {\r\n    async fetchBookList(query = '') {\r\n      try {\r\n        const response = await axios.get(`/api/books?search=${query}`);\r\n        this.books = response.data;\r\n      } catch (error) {\r\n        console.error('获取图书列表失败:', error);\r\n        this.$message.error('获取图书列表失败');\r\n      }\r\n    },\r\n    handleSelectionChange(val) {\r\n      this.selectedBooks = val.map(item => item.id);\r\n    },\r\n    handleEdit(row) {\r\n      this.editForm = { ...row };\r\n      this.showEditModal = true;\r\n    },\r\n    onSearch() {\r\n      this.fetchBookList(this.searchQuery);\r\n    },\r\n    async submitAdd() {\r\n      try {\r\n        await this.$refs.addFormRef.validate();\r\n        await axios.post('/api/books', this.addForm);\r\n        this.showAddModal = false;\r\n        this.fetchBookList();\r\n        this.$message.success('添加成功');\r\n      } catch (error) {\r\n        this.$message.error('添加失败');\r\n      }\r\n    },\r\n    async submitEdit() {\r\n      try {\r\n        await this.$refs.editFormRef.validate();\r\n        await axios.put(`/api/books/${this.editForm.id}`, this.editForm);\r\n        this.showEditModal = false;\r\n        this.fetchBookList();\r\n        this.$message.success('更新成功');\r\n      } catch (error) {\r\n        this.$message.error('更新失败');\r\n      }\r\n    },\r\n    handleSingleDelete(id) {\r\n      this.selectedBooks = [id];\r\n      this.showConfirmDeleteModal = true;\r\n    },\r\n    async submitBatchDelete() {\r\n      try {\r\n        await axios.delete('/api/books', { data: { ids: this.selectedBooks } });\r\n        this.showConfirmDeleteModal = false;\r\n        this.fetchBookList();\r\n        this.$message.success('删除成功');\r\n      } catch (error) {\r\n        this.$message.error('删除失败');\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.mb-20 {\r\n  margin-bottom: 20px;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}